<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Test">
    <select id="select_all_device">
    SELECT device_list.id, device_list.name, driver_list.name AS connect_type, device_type.name AS device_type
    FROM device_list
    INNER JOIN device_type ON device_list.id_device_type=device_type.id
    INNER JOIN communication ON device_list.id_communication=communication.id
    INNER JOIN driver_list ON communication.id_driver_list=driver_list.id where device_list.status=1;
    </select>
    
    <select id="select_only_device">
        SELECT device_list.id, device_list.name, 
        device_list.rtu_bus_address AS rtu_bus_address,
        device_list.tcp_gateway_ip AS tcp_gateway_ip,
        device_list.tcp_gateway_port AS tcp_gateway_port,
        driver_list.name AS connect_type, device_type.name AS device_type,
        

        device_group.name as device_group,
        template_library.name as template_name
        FROM device_list
        INNER JOIN device_type ON device_list.id_device_type=device_type.id
        INNER JOIN communication ON device_list.id_communication=communication.id
        INNER JOIN driver_list ON communication.id_driver_list=driver_list.id 
        INNER JOIN device_group ON device_list.id_device_group=device_group.id
        INNER JOIN template_library ON device_group.id_template=template_library.id
        where 
        device_list.id=%s;
        </select>
    <select id="select_point_list">
            SELECT device_list.id, device_list.name, 
            driver_list.name AS connect_type, device_type.name AS device_type,
            device_group.name AS device_group,
            template_library.name AS template_name,
            point_list.id_pointkey,point_list.name AS unit_desc,point_list.register, 
            point_list.slope, point_list.slopeenabled,point_list.offsetenabled,
            point_list.offset,
	          table_byteorder.value AS value_byteorder,
	          table_byteorder.namekey AS name_byteorder,
	          table_datatype.value AS value_datatype,
	          table_datatype.namekey AS name_datatype,
	          table_units.value AS value_units,
	          table_units.namekey AS name_units
            FROM device_list
            INNER JOIN device_type ON device_list.id_device_type=device_type.id
            INNER JOIN communication ON device_list.id_communication=communication.id
            INNER JOIN driver_list ON communication.id_driver_list=driver_list.id 
            INNER JOIN device_group ON device_list.id_device_group=device_group.id
            INNER JOIN template_library ON device_group.id_template=template_library.id
            INNER JOIN point_list ON template_library.id=point_list.id_template
	          INNER JOIN config_information table_byteorder ON point_list.id_type_byteorder=table_byteorder.id
	          INNER JOIN config_information table_datatype ON point_list.id_type_datatype=table_datatype.id
	          LEFT JOIN config_information table_units ON point_list.id_type_units=table_units.id
            where point_list.status=1 and
            device_list.id=%s;
            </select>
        <select id="select_register_block">
                SELECT device_list.id, device_list.name, 
                driver_list.name AS connect_type, device_type.name AS device_type,
                device_group.name as device_group,
                template_library.name as template_name,
                register_block.addr as addr,register_block.count as count,
                config_information.namekey as namekey,
                config_information.value as Function
                FROM device_list
                INNER JOIN device_type ON device_list.id_device_type=device_type.id
                INNER JOIN communication ON device_list.id_communication=communication.id
                INNER JOIN driver_list ON communication.id_driver_list=driver_list.id 
                INNER JOIN device_group ON device_list.id_device_group=device_group.id
                INNER JOIN template_library ON device_group.id_template=template_library.id
                INNER JOIN register_block ON template_library.id=register_block.id_template
                INNER JOIN config_information ON register_block.id_type_function=config_information.id
                where register_block.status=1 and
                device_list.id=%s;
                </select>
                <select id="select_device_control"> 
                  SELECT device_list.id, device_list.name,  
                  device_list.point_p,device_list.value_p,device_list.send_p,
                  device_list.point_q,device_list.value_q,device_list.send_q,
                  device_list.point_pf,device_list.value_pf,device_list.send_pf,
                  device_list.enable_poweroff, device_list.inverter_shutdown,
                  
                  table_p.register AS register_p , table_p.id_type_datatype AS datatype_p,
                  table_q.register AS register_p, table_q.id_type_datatype AS datatype_q,
                  table_pf.register AS register_pf, table_pf.id_type_datatype AS datatype_pf
                  
                  
                  FROM device_list
                  INNER JOIN point_list table_p ON device_list.point_p=table_p.id
                  INNER JOIN point_list table_q ON device_list.point_q=table_q.id
                  INNER JOIN point_list table_pf ON device_list.point_q=table_pf.id
                  
                  WHERE device_list.status=1 AND device_list.name =%s ;
                </select>    
</mapper>
